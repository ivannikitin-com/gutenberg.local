Генерация и установка SSL сертификата localhost в Windows
=========================================================

Генерация сертификата
---------------------
Генерация производится командой PowerShell в хранилище сертификатов Windows.
Важно это сделать с правами администратора!
```
New-SelfSignedCertificate -DnsName gutenberg.local -CertStoreLocation cert:\LocalMachine\My
```

Появится отпечаток этого сертификата
```
Thumbprint                                Subject
----------                                -------
3FD443B76CD2015D3D011CD75499D19BD810518B  CN=gutenberg.local
```

Перемещение сертификата в доверенное хранилище и его экспорт
------------------------------------------------------------
Далее необходимо открыть оснастку “Сертификаты” с правами локального администратора, 
для этого нужно запустить соответствующий файл `certmgr.msc` 
и произвести поиск сгенерированного сертификата по его DNS имени, 
например, `gutenberg.local`.

Далее, найденный сертификат необходимо переместить в раздел “Доверенные корневые центры сертификации\Сертификаты”
через операцию Вырезать - Вставить.

Экспорт сертификата с закрытым ключoм в формат .pfx
---------------------------------------------------
Для экспорта полученного сертификата c закрытым ключом в pfx файл, защищенный паролем, нужно получить его отпечаток (Thumbprint). Сначала нужно указать пароль защиты сертификата и преобразовать его в формат SecureString. Значение Thumbprint нужно скопировать из результатов выполнения команды New-SelfSignedCertificate.

```
$CertPassword = ConvertTo-SecureString -String "YourPassword" -Force –AsPlainText

Export-PfxCertificate -Cert cert:\LocalMachine\My\3FD443B76CD2015D3D011CD75499D19BD810518B -FilePath .\gutenberg.local.pfx -Password $CertPassword
```

Извлечение файлов ключей из сертификата .pfx
--------------------------------------------
Делается утилитой `openssl` в Linux (WSL). Эти команды выполняются из обычного PowerShell, не из под админа!

```
wsl openssl pkcs12 -in ./certname.pfx -nocerts -out ./key.pem -nodes
wsl openssl pkcs12 -in ./certname.pfx -nokeys -out ./cert.pem
wsl openssl rsa -in ./key.pem -out ./server.key
```

Полученные файлы можно использовать на веб-сервере. 